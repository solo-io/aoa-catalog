apiVersion: gateway.gloo.solo.io/v1alpha1
kind: DirectResponse
metadata:
  name: howto-httpbin-direct-response
  namespace: homer-portal
spec:
  status: 200
  body: |
    <!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Httpbin Demo Walkthrough</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><style>body{font-family:Arial,sans-serif;margin:0;padding:0;overflow-x:hidden}.parallax-container{display:flex;align-items:center;justify-content:center;height:30vh;background:linear-gradient(45deg,#3498db,#9b59b6);color:#fff;text-align:center;position:relative}.parallax-content{z-index:2;padding:20px}.parallax-bg{position:absolute;width:100%;height:100%;z-index:1;opacity:.5}h1{font-size:36px;margin-bottom:20px}h2{font-size:24px;margin-bottom:10px}.note{background:rgba(255,255,255,.9);border-radius:8px;padding:20px;margin:20px 0;box-shadow:0 4px 8px rgba(0,0,0,.1);transition:transform .3s}.note:hover{transform:scale(1.03)}.highlight{color:#3498db;font-weight:bold}.icon{font-size:32px;margin-right:10px;color:#3498db}</style></head><body><div class="parallax-container"><div class="parallax-bg"></div><div class="parallax-content"><h1>Httpbin Demo Walkthrough</h1></div></div><div class="parallax-content"><div class="note"><h2><i class="icon fas fa-cogs"></i><span class="highlight">Application Description:</span></h2><p>Httpbin is useful for testing HTTP clients, demonstrating routing, security policies, and transformations.</p></div><div class="note"><h2><i class="icon fas fa-globe"></i><span class="highlight">Httpbin Public Endpoint:</span></h2><p>This is the publicly facing endpoint for httpbin, exposed via Gloo Gateway.</p></div><div class="note"><h2><i class="icon fas fa-lock"></i><span class="highlight">Ext Auth with Okta:</span></h2><p>This demo shows how to secure httpbin with Okta and ExtAuthPolicy. Use jdoe@solo.io/gloo-dev to log in.</p><ol><li>Navigate to the protected /get tile to see the Okta login redirect</li><li>Log in to access the protected endpoint</li><li>Note the id_token and access_token in the headers</li><li>Review the `httpbin-extauth` ExtAuthPolicy in Gloo Mesh UI > Policies</li></ol></div><div class="note"><h2><i class="icon fas fa-stopwatch"></i><span class="highlight">Rate Limiting:</span></h2><p>Rate limiting is set to 1000 requests per minute.</p><ol><li>Review the `httpbin` RateLimitPolicy in Gloo Mesh UI > Policies</li><li>Check that it is applied to the httpbin-rt-443 route</li></ol></div><div class="note"><h2><i class="icon fas fa-user-shield"></i><span class="highlight">JWT Validation, ClaimsToHeaders, and Transformations:</span></h2><p>This demo shows how Gloo Gateway validates JWT tokens and extracts claims for headers.</p><ol><li>See response headers at the /get endpoint</li><li>Decode the JWT token to view claims for `email` and `groups`</li><li>Review the `httpbin-claimstoheaders` JWTPolicy in Gloo Mesh UI > Policies</li><li>Check the `modify-x-email-header` TransformationPolicy for creating headers</li></ol></div><div class="note"><h2><i class="icon fas fa-shield-alt"></i><span class="highlight">OPA AuthZ:</span></h2><p>This demo shows how to use OPA for authorization.</p><ol><li>Review the `httpbin-extauth` ExtAuthPolicy in Gloo Mesh UI > Policies</li><li>Check the OPA rules in the `httpbin-opa` configmap via Argo CD UI</li><li>Test the /status/200 endpoint to trigger a 403</li></ol></div><div class="note"><h2><i class="icon fas fa-shield"></i><span class="highlight">WAF policy:</span></h2><p>This demo configures OWASP CRS rules to protect httpbin with a WAFPolicy.</p><ol><li>Review the `httpbin-waf` WAFPolicy in Gloo Mesh UI > Policies</li><li>Inject a "scammer" User-Agent header at the /get endpoint to trigger a WAF rule</li></ol></div></div><script>window.addEventListener('scroll',function(){document.querySelector('.parallax-bg').style.transform='translateY('+window.scrollY*.5+'px)'});</script></body></html>

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
#- rollouts-demo-deploy.yaml
- rollouts-demo-ns.yaml
- rollouts-demo-rollout.yaml
- rollouts-demo-service.yaml
- rollouts-demo-httproute.yaml
- rollouts-demo-route-policies.yaml

# patch nodeSelector and tolerations on all Deployments
patches:
- patch: |-
    kind: not-important
    metadata:
      name: not-important
    spec:
      template:
        spec:
          nodeSelector:
            node: "spot"
          tolerations:
          - key: cloud.google.com/node
            operator: Equal
            value: "spot"
            effect: NoSchedule
  target:
    kind: Deployment


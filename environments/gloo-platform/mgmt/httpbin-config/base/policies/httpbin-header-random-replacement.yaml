apiVersion: trafficcontrol.policy.gloo.solo.io/v2
kind: TransformationPolicy
metadata:
  name: custom-request-header-replacement
  namespace: httpbin
spec:
  applyToRoutes:
  - route:
      labels:
        route: httpbin-headers
  config:
    phase:
      postAuthz:
        priority: -1
    request:
      injaTemplate:
        advancedTemplates: false
        parseBodyBehavior: DontParse
        headers:
          custom-request-header-1:
            text: '{{ replace_with_random(header("custom-request-header-1"), "pattern-to-replace") }}'

apiVersion: trafficcontrol.policy.gloo.solo.io/v2
kind: TransformationPolicy
metadata:
  name: id-token-public-replacement
  namespace: httpbin
spec:
  applyToRoutes:
  - route:
      labels:
        route: httpbin-public
  config:
    phase:
      postAuthz:
        priority: 10
    response:
      injaTemplate:
        advancedTemplates: false
        parseBodyBehavior: DontParse
        headers:
          id_token:
            text: '{{ replace_with_random(header("id_token"), "pattern-to-replace") }}'

apiVersion: trafficcontrol.policy.gloo.solo.io/v2
kind: TransformationPolicy
metadata:
  name: 404-missing-header-transformation
  namespace: bookinfo-team-config
spec:
  applyToRoutes:
  - route:
      labels:
        route: reviews-v2
  config:
    phase:
      preAuthz:
        priority: 0
    response:
      injaTemplate:
        body:
          text: '{% if header(":status") == "404" %}<html><body style="background-color:powderblue;"><h1>Error Code: 404</h1><p>Check to see if missing the header - "user: preferred"</p></body></html>{%
            else %}{{ body() }}{% endif %}'
        parseBodyBehavior: DontParse
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: howto-security-delegate-vs
  namespace: gloo-mesh
spec:
  http:
  - name: security
    match:
    - uri:
        exact: /security
    headers:
      response:
        set:
          content-type: "text/html"
    directResponse:
      status: 200
      body:
        string: |
          <!DOCTYPE html>
          <html lang="en">          

          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>Gloo Mesh Core Security Persona Walkthrough</title>
              <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
              <style>
                  body {
                      font-family: 'Arial', sans-serif;
                      margin: 0;
                      padding: 0;
                      overflow-x: hidden;
                  }          

                  .parallax-container {
                      display: flex;
                      flex-direction: column;
                      align-items: center;
                      justify-content: center;
                      height: 30vh;
                      background: linear-gradient(45deg, #3498db, #9b59b6);
                      color: #fff;
                      text-align: center;
                      position: relative;
                  }          

                  .parallax-content {
                      position: relative;
                      z-index: 2;
                      padding: 20px;
                  }          

                  .parallax-bg {
                      position: absolute;
                      top: 0;
                      left: 0;
                      width: 100%;
                      height: 100%;
                      z-index: 1;
                      opacity: 0.5;
                  }          

                  h1 {
                      font-size: 36px;
                      margin-bottom: 20px;
                  }          

                  h2 {
                      font-size: 24px;
                      margin-bottom: 10px;
                  }          

                  p {
                      line-height: 1.6;
                  }          

                  .note {
                      background-color: rgba(255, 255, 255, 0.9);
                      border-radius: 8px;
                      padding: 20px;
                      margin: 20px 0;
                      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                      transition: transform 0.3s ease-in-out;
                  }          

                  .note:hover {
                      transform: scale(1.03);
                  }          

                  .highlight {
                      color: #3498db;
                      font-weight: bold;
                  }          

                  .icon {
                      font-size: 32px;
                      margin-right: 10px;
                      color: #3498db;
                  }
              </style>
          </head>          

          <body>
              <div class="parallax-container">
                  <div class="parallax-bg"></div>
                  <div class="parallax-content">
                      <h1>Gloo Mesh Core Security Persona Walkthrough</h1>
                  </div>
              </div>          

              <div class="parallax-content">
                  <!-- Validate Zero Trust Using the Service Graph -->
                  <div class="note">
                      <h2><i class="icon far fa-lightbulb"></i><span class="highlight">Validate Zero Trust Using the Service Graph:</span></h2>
                      <p><span class="highlight">Description:</span> Leverage the Gloo Mesh Core UI for details into zero-trust posture </p>
                      <ol>
                          <li>Navigate to the Observability > Graph</li>
                          <li>Using the drop-down filters, select the Cluster and Namespace of your target service such as web-ui and backend-apis for online-boutique app</li>
                          <li>Note the lock icon which signifies the service-to-service communication is configured with mTLS</li>
                          <li>Select an edge containing a lock icon, notice additional detail panels on mTLS</li>
                          <li>Hover over the info button next to mTLS: mutual_tls</li>
                          <li>Note the spiffe IDs for the mTLS connection</li>
                      </ol>
                  </div> 

              <div class="parallax-content">
                  <!-- Validate FIPS Compliance Across your Fleet of Clusters -->
                  <div class="note">
                      <h2><i class="icon far fa-lightbulb"></i><span class="highlight">Validate FIPS Compliance Across your Fleet of Clusters:</span></h2>
                      <p><span class="highlight">Description:</span> Leverage the Gloo Mesh Core UI for details into FIPS compliance </p>
                      <ol>
                          <li>Navigate to the main dashboard of the Gloo Mesh Core UI</li>
                          <li>Notice the Istio FIPS panel which detects Control Planes and Data Plane Workloads with FIPS enabled </li>
                          <li>You can also view the Istio version in the middle-left panel under "Environment Check". When using a Solo distribution, the version will be tagged with -fips. </li>
                          <li>The FIPS details in this panel will reflect all clusters registered to the Gloo Mesh Core control plane </li>
                      </ol>
                  </div>                       

              <script>
                  window.addEventListener('scroll', function () {
                      var scrolled = window.scrollY;
                      var parallaxBg = document.querySelector('.parallax-bg');
                      parallaxBg.style.transform = 'translateY(' + scrolled * 0.5 + 'px)';
                  });
              </script>
          </body>          

          </html>